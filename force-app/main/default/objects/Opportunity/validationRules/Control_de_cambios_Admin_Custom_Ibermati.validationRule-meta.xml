<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Control_de_cambios_Admin_Custom_Ibermati</fullName>
    <active>true</active>
    <errorConditionFormula>AND(
    $Profile.Name &lt;&gt; &apos;Administrador del sistema&apos;,
    
    $Profile.Name &lt;&gt; &apos;System Administrator&apos;,
    
NOT(ISNEW()),
NOT(ISPICKVAL(Tipo_Extension__c, &apos;Extensión Rectificativa&apos;)),
OR(
ISPICKVAL(Motivo_de_excepcion__c, &quot;&quot;),
ISBLANK(TEXT(Motivo_de_excepcion__c))
),
OR(
CONTAINS($User.Email, &apos;xantonana@ayesa&apos;),
CONTAINS($User.Email, &apos;vmoctavio@ayesa&apos;),
$Profile.Name = &apos;Admin Custom Ibermatica CRM Sales&apos;
),
/* Excluir el caso en que el perfil sea Admin Custom Ibermatica CRM y cambie alguno de los tres campos */
  NOT(
     AND(
        $Profile.Name = &quot;Admin Custom Ibermatica CRM Sales&quot;,
        OR(
          ISCHANGED(Responsable_de_Proyecto_Nombre__c),
          ISCHANGED(Responsable_de_Proyecto_Email__c),
          ISCHANGED(Responsable_de_Proyecto__c)
          )
        )
     )
)</errorConditionFormula>
    <errorDisplayField>Motivo_de_excepcion__c</errorDisplayField>
    <errorMessage>Debe rellenar el campo &apos;Motivo de excepción&apos; antes de guardar los cambios.</errorMessage>
</ValidationRule>
